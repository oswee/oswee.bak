# Oswee

This is a **personal** distributed microservices pet-project.

## Current state

17-Aug-2019
Made some small project reorganization and moved code from /domain to /internal. Introduced high level domains
like /core, /shipping, /web.
Somehow it feels right direction.

12-Aug-2019
Currently managed to Dockerize `./domains/public/` (UPD: Renamed to `/internal/web/public`) (multi-stage scratch build) which is public frontend.
I think i will split front-end in two parts.

1) For public guest users and
2) For authenticated users.

I am thinking on splitting front-end in self-contined components (Composite UI?)
where each component could be deployed independently by its team, but ...
it leads to some questions i should research. Like, how to manage composition of those components.
How to handle Redux part in such case because every component would have its own independent redux store,
but if every action exchange would happend via HTTP/2 / WebSockets and supporting backend services,
this would lead to somehow slow UI.
A lot to think/learn of.

As well today i made Storybook implementation. It seems to work. Next steps would be to split that into separate
Go webserver.

Some of next tasks/milestones would be to implement User domain services to Sign Up, Sign In, Restore Password.

## This project contains a stack of

### Back-end

- Go
- gRPC
- Protocol Buffers
- Kafka
- Event-Sourcing/CQRS
- MariaDB
- Redis

### Front-end

- TypeScript
- Web Components
- LitElement
- Lit-html
- Redux
- Redux Sagas
- SCSS/SMACSS
- PWA
- WebPack

Back-End project structure are based on Golang's unofficial [Golang Standard Project Layout](https://github.com/golang-standards/project-layout).
Front-End project structure are based on [CRUV](https://frontarm.com/james-k-nelson/react-cruv/) and [Redux Ducks](https://github.com/erikras/ducks-modular-redux) project layouts.


github.com/<username>/<monorepo>/api/v1/proto                               // Contains all *.proto files for every
github.com/<username>/<monorepo>/api/v1/swagger                             // Contains all Swagger files generated by Swagger gRPC plugin

github.com/<username>/<monorepo>/domain/user/svc/api/cmd                    // Command API Service is just a REST and gRPC gateway for write side. All request goes thru AuthN/Z process.
github.com/<username>/<monorepo>/domain/user/svc/api/qry                    // Query API Service is just a REST and gRPC gateway for read side. All request goes thru AuthN/Z process.
github.com/<username>/<monorepo>/domain/user/svc/cmd                        // Command Service receives gRPC calls, does basic validation and stores commands "as-is" in Kafka. Commands are not mutated to keep track on who does what.
github.com/<username>/<monorepo>/domain/user/svc/qry                        // Query Service handles gRPC calls and returns materialized views from data stores.
github.com/<username>/<monorepo>/domain/user/svc/hdl                        // Event-Handler Service consumes Kafka commands or events and produces new commands or events which are stored back in Kafka. All business logic is handled there.
github.com/<username>/<monorepo>/domain/user/svc/den                        // Denormalizer Service transforms events into materialized views.

github.com/<username>/<monorepo>/domain/sales/order/svc/api/cmd - main.go             // https://api.domain.com/v1/sales/order (order.app.ocp.domain.com:NNNNN)
github.com/<username>/<monorepo>/domain/sales/order/svc/api/qry - main.go             // https://api.domain.com/v1/sales/order (order.app.ocp.domain.com:NNNNN)
github.com/<username>/<monorepo>/domain/sales/order/svc/cmd - main.go
github.com/<username>/<monorepo>/domain/sales/order/svc/qry - main.go
github.com/<username>/<monorepo>/domain/sales/order/svc/hdl - main.go
github.com/<username>/<monorepo>/domain/sales/order/svc/den - main.go

github.com/<username>/<monorepo>/domain/warehouse/order/svc/api/cmd - main.go         // https://api.domain.com/v1/warehouse/order (warehouse.app.ocp.domain.com:NNNNN)
github.com/<username>/<monorepo>/domain/warehouse/order/svc/api/qry - main.go         // https://api.domain.com/v1/warehouse/order (warehouse.app.ocp.domain.com:NNNNN)
github.com/<username>/<monorepo>/domain/warehouse/order/svc/cmd - main.go
github.com/<username>/<monorepo>/domain/warehouse/order/svc/qry - main.go
github.com/<username>/<monorepo>/domain/warehouse/order/svc/hdl - main.go
github.com/<username>/<monorepo>/domain/warehouse/order/svc/den - main.go

github.com/<username>/<monorepo>/domain/shipping/order/svc/api/cmd                              // This is a stand-alone/self-contained service/binary/applicaction.
github.com/<username>/<monorepo>/domain/shipping/order/svc/api/cmd/cmd
github.com/<username>/<monorepo>/domain/shipping/order/svc/api/cmd/cmd/main.go                  // Pretty empty main.go which calls a Server from /pkg/cmd/server
github.com/<username>/<monorepo>/domain/shipping/order/svc/api/cmd/pkg
github.com/<username>/<monorepo>/domain/shipping/order/svc/api/cmd/pkg/api/v1/shipping.pb.go
github.com/<username>/<monorepo>/domain/shipping/order/svc/api/cmd/pkg/cmd/server.go
github.com/<username>/<monorepo>/domain/shipping/order/svc/api/cmd/service/
github.com/<username>/<monorepo>/domain/shipping/order/svc/api/cmd/build
github.com/<username>/<monorepo>/domain/shipping/order/svc/api/cmd/build/Dockerfile
github.com/<username>/<monorepo>/domain/shipping/order/svc/api/cmd/go.mod
github.com/<username>/<monorepo>/domain/shipping/order/svc/api/cmd/go.sum

github.com/<username>/<monorepo>/internal/public-frontend                           // MONOLITH :( ??? Front-End SPA for non-authenticated users (any guest user). Still thinking, how to incorporate Composable UI, where every domain/sub-domain team could be responsible only for its part.
github.com/<username>/<monorepo>/internal/private-frontent                          // MONOLITH :( ??? Front-End SPA for authenticated users (where all the main magic happens)

github.com/<username>/<monorepo>/internal/config                            // Some kind of Config Service/Application
github.com/<username>/<monorepo>/internal/config/cmd
github.com/<username>/<monorepo>/internal/config/pkg
github.com/<username>/<monorepo>/internal/config/build
github.com/<username>/<monorepo>/internal/config/go.mod
github.com/<username>/<monorepo>/internal/config/go.sum

github.com/<username>/<monorepo>/internal/ws                                // wss://api.domain.com (ws.app.ocp.domain.com:NNNNN) WebSocket API ???? Who knows..

github.com/<username>/<monorepo>/pkg/logger
github.com/<username>/<monorepo>/pkg/metrics
github.com/<username>/<monorepo>/pkg/tracing

github.com/<username>/<monorepo>/build          // Dockerfiles, makefiles etc.
github.com/<username>/<monorepo>/scripts        // Contains scripts to generate protobufs, etc.
github.com/<username>/<monorepo>/***

https://www.reddit.com/r/golang/comments/cro62b/help_wanted_how_to_organize_multiple_services_in/
https://rentry.co/rr9s8
rVN5ncLS










github.com/<username>/<monorepo>/api/v1/proto                                   // Contains all *.proto files for every
github.com/<username>/<monorepo>/api/v1/swagger                                 // Contains all Swagger files generated by Swagger gRPC plugin

github.com/<username>/<monorepo>/internal/core/user/command-gateway             // Command API Service is just a REST and gRPC gateway for write side. All request goes thru AuthN/Z process.
github.com/<username>/<monorepo>/internal/core/user/query-gateway               // Query API Service is just a REST and gRPC gateway for read side. All request goes thru AuthN/Z process.
github.com/<username>/<monorepo>/internal/core/user/command-handler             // Command Service receives gRPC calls, does basic validation and stores commands "as-is" in Kafka. Commands are not mutated to keep track on who does what.
github.com/<username>/<monorepo>/internal/core/user/query-handler               // Query Service handles gRPC calls and returns materialized views from data stores.
github.com/<username>/<monorepo>/internal/core/user/event-handler               // Event-Handler Service consumes Kafka commands or events and produces new commands or events which are stored back in Kafka. All business logic is handled there.
github.com/<username>/<monorepo>/internal/core/user/denormalizer                // Denormalizer Service transforms events into materialized views.

github.com/<username>/<monorepo>/internal/sales/order/svc/api/cmd - main.go             // https://api.domain.com/v1/sales/order (order.app.ocp.domain.com:NNNNN)
github.com/<username>/<monorepo>/internal/sales/order/svc/api/qry - main.go             // https://api.domain.com/v1/sales/order (order.app.ocp.domain.com:NNNNN)
github.com/<username>/<monorepo>/internal/sales/order/svc/cmd - main.go
github.com/<username>/<monorepo>/internal/sales/order/svc/qry - main.go
github.com/<username>/<monorepo>/internal/sales/order/svc/hdl - main.go
github.com/<username>/<monorepo>/internal/sales/order/svc/den - main.go

github.com/<username>/<monorepo>/internal/warehouse/order/svc/api/cmd - main.go         // https://api.domain.com/v1/warehouse/order (warehouse.app.ocp.domain.com:NNNNN)
github.com/<username>/<monorepo>/internal/warehouse/order/svc/api/qry - main.go         // https://api.domain.com/v1/warehouse/order (warehouse.app.ocp.domain.com:NNNNN)
github.com/<username>/<monorepo>/internal/warehouse/order/svc/cmd - main.go
github.com/<username>/<monorepo>/internal/warehouse/order/svc/qry - main.go
github.com/<username>/<monorepo>/internal/warehouse/order/svc/hdl - main.go
github.com/<username>/<monorepo>/internal/warehouse/order/svc/den - main.go

github.com/<username>/<monorepo>/internal/shipping/order/svc/api/cmd                              // This is a stand-alone/self-contained service/binary/applicaction.
github.com/<username>/<monorepo>/internal/shipping/order/svc/api/cmd/cmd
github.com/<username>/<monorepo>/internal/shipping/order/svc/api/cmd/cmd/main.go                  // Pretty empty main.go which calls a Server from /pkg/cmd/server
github.com/<username>/<monorepo>/internal/shipping/order/svc/api/cmd/pkg
github.com/<username>/<monorepo>/internal/shipping/order/svc/api/cmd/pkg/api/v1/shipping.pb.go
github.com/<username>/<monorepo>/internal/shipping/order/svc/api/cmd/pkg/cmd/server.go
github.com/<username>/<monorepo>/internal/shipping/order/svc/api/cmd/service/
github.com/<username>/<monorepo>/internal/shipping/order/svc/api/cmd/build
github.com/<username>/<monorepo>/internal/shipping/order/svc/api/cmd/build/Dockerfile
github.com/<username>/<monorepo>/internal/shipping/order/svc/api/cmd/go.mod
github.com/<username>/<monorepo>/internal/shipping/order/svc/api/cmd/go.sum

github.com/<username>/<monorepo>/internal/public-frontend                           // MONOLITH :( ??? Front-End SPA for non-authenticated users (any guest user). Still thinking, how to incorporate Composable UI, where every domain/sub-domain team could be responsible only for its part.
github.com/<username>/<monorepo>/internal/private-frontent                          // MONOLITH :( ??? Front-End SPA for authenticated users (where all the main magic happens)

github.com/<username>/<monorepo>/internal/core/config                            // Some kind of Config Service/Application
github.com/<username>/<monorepo>/internal/core/config/cmd
github.com/<username>/<monorepo>/internal/core/config/pkg
github.com/<username>/<monorepo>/internal/core/config/build
github.com/<username>/<monorepo>/internal/core/config/go.mod
github.com/<username>/<monorepo>/internal/core/config/go.sum

github.com/<username>/<monorepo>/internal/core/ws                                // wss://api.domain.com (ws.app.ocp.domain.com:NNNNN) WebSocket API ???? Who knows..

github.com/<username>/<monorepo>/pkg/logger
github.com/<username>/<monorepo>/pkg/metrics
github.com/<username>/<monorepo>/pkg/tracing

github.com/<username>/<monorepo>/build          // Dockerfiles, makefiles etc.
github.com/<username>/<monorepo>/scripts        // Contains scripts to generate protobufs, etc.
github.com/<username>/<monorepo>/***
